
using { /Verse.org/Simulation }
using { /UnrealEngine.com/Temporary/UI }

game_hud<public> := interface():
    CreateCanvas<public>():canvas

create_hud := type{_(:game_state, :string):game_hud}

(GameState:game_state).AddHUD<public>(Name:string, CreateHUD:create_hud, ?Clickable:logic = false):void=
    HUD := hud{ Name := Name, Clickable := Clickable, CreateHUD := CreateHUD }
    Watcher := participant_watcher:
        GameState := GameState
        OnPossessed := HUD.AttachHUD
    spawn. Watcher.Start()

hud := class():
    Name<public>:string
    Clickable<public>:logic
    CreateHUD<public>:create_hud

    AttachHUD<public>(GameState:game_state, ParticipantID:string, Agent:agent):void=
        if (UI := GetPlayerUI[player[Agent]]):
            Canvas := CreateHUD(GameState, ParticipantID).CreateCanvas()
            Input := if (Clickable?). ui_input_mode.All else. ui_input_mode.None
            UI.AddWidget(Canvas, player_ui_slot. InputMode := Input)
