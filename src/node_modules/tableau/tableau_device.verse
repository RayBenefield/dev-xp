
using. /Verse.org/Simulation
using. /Fortnite.com/Devices
using. /Verse.org/Simulation/Tags

tableau_device_tag := class(tag){}

LoadTableauDevices<public>():[]tableau_device=
    TaggedDevices := GetCreativeObjectsWithTag(tableau_device_tag{})
    for(Index -> Tagged : TaggedDevices, Device := tableau_device[Tagged]). Device

per_resource<public> := class<concrete>(side_effect_settings):
    @editable PerResource<override>:logic = true
side_effect_settings<public> := class<concrete>():
    @editable PerResource<public>:logic = false
    @editable SubResourceID<public>:string = "Player"
    @editable PerSubResource<public>:logic = true

device_settings<public> := class<concrete>():

tableau_device<public> := class(creative_device):
    @editable ResourceID<public>:string = "Resource ID"
    @editable SideEffectSettings<public>:side_effect_settings = side_effect_settings{}
    # REQUEST: Doesn't work in the details panel, should be overridable in the future
    # @editable Settings<public>:device_settings = device_settings{}

    GetResources<public>():[]resource= array{}

    GetResourceID<public>()<computes>:?string= if (not SideEffectSettings.PerResource?). option{ ResourceID } else. false
    GetPerType<public>()<computes>:?string= if (SideEffectSettings.PerResource?). option{ ResourceID } else. false
    GetPerSubType<public>()<computes>:?string= if (SideEffectSettings.PerSubResource?). option{ SideEffectSettings.SubResourceID } else. false
    GetSideEffects<public>(State:scoped_state)<suspends>:[]side_effect= array{}
