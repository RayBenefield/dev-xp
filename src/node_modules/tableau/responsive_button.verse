
using { /Fortnite.com/UI }
using { /UnrealEngine.com/Temporary/UI }

responsive_button<public> := class(game_hud):
    GooeyText<public>:gooey_string
    GooeyEnabled<public>:gooey_bool
    Button<public>:text_button_base
    Action<public>:tap

    Initialize<override>():widget=
        Button.OnClick().Subscribe(OnPressed)
        spawn. KeepUpdated()
        Button

    KeepUpdated()<suspends>:void=
        MessageVM := gooey_message. VM := Map(GooeyText, Str2Msg)
        Button.SetText(MessageVM.Get())
        Button.SetEnabled(GooeyEnabled.Get())
        loop:
            if (1 = 0). break
            race:
                block:
                    Msg := MessageVM.UpdatedEvent().Await()
                    Button.SetText(Msg)
                block:
                    Enabled := GooeyEnabled.UpdatedEvent().Await()
                    Button.SetEnabled(Enabled)

    OnPressed(Msg:widget_message):void = Action()
