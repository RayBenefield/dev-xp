
using. /Verse.org/Simulation

using. Vertex

switcher_settings<public> := class<concrete>():
    @editable ID<public>:string = "Root Context"
    @editable StartingContext<public>:string = ""
    @editable Actions<public>:[]string = array{}

CreateContextSwitcherResource<public>(S:switcher_settings):resource=
    var AllActions:[string]ability = map{}
    for(NextAction:S.Actions):
        var NewAction:[string]ability = map{}
        ExecuteAction := ability. Effects := array. Execute(Path("Context"), NextAction)
        option:
            set NewAction[NextAction] = ExecuteAction
            set AllActions = ConcatenateMaps(AllActions, NewAction)

    resource:
        ID := S.ID
        Props := map:
            "Context" => prop_str. Default := S.StartingContext
        Abilities := AllActions