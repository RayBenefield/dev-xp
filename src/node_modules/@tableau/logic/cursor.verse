
using. /Verse.org/Simulation

using. Tableau
using. TableauEffect
using. TableauResource

cursor_settings<public> := class<concrete>():
    @editable ID<public>:string = "Cursor"
    @editable GridSize<public>:float = 128.0

CreateCursorResource<public><constructor>(C:cursor_settings) := resource:
    ID := C.ID
    Props := map:
        "ONE" => prop_float. Default := 1.0
        "-ONE" => prop_float. Default := -1.0
        "ZERO" => prop_float. Default := 0.0
        "COMMA" => prop_str. Default := ","
        "X" => prop_int{}
        "Y" => prop_int{}
        "Grid Size" => prop_float. Default := C.GridSize
        "Right" => prop_int{ Focus := Path("X"), FN := "+", Tweak := Path("ONE")}
        "Left" => prop_int{ Focus := Path("X"), FN := "+", Tweak := Path("-ONE")}
        "Forward" => prop_int{ Focus := Path("Y"), FN := "+", Tweak := Path("-ONE")}
        "Back" => prop_int{ Focus := Path("Y"), FN := "+", Tweak := Path("ONE")}
        "X Coord" => prop_float{ Focus := Path("X"), FN := "*", Tweak := Path("Grid Size") }
        "Y Coord" => prop_float{ Focus := Path("Y"), FN := "*", Tweak := Path("Grid Size") }
        "XY Location" => prop_vec2{ Focus := Path("X Coord"), FN := "Append", Tweak := Path("Y Coord") }
        "Location" => prop_vec3{ Focus := Path("XY Location"), FN := "Append", Tweak := Path("ZERO") }
        "Partial ID" => prop_str{ Focus := Path("X"), FN := "Append", Tweak := Path("COMMA") }
        "Location ID" => prop_str{ Focus := Path("Partial ID"), FN := "Append", Tweak := Path("Y") }
    Abilities := map:
        "Move Left" => ability. Effects := array:
            Set("X").To("Left")
        "Move Right" => ability. Effects := array:
            Set("X").To("Right")
        "Move Forward" => ability. Effects := array:
            Set("Y").To("Forward")
        "Move Back" => ability. Effects := array:
            Set("Y").To("Back")
