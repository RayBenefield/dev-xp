
using { /Fortnite.com/Devices }
using { /Verse.org/Simulation }

using { Tableau }
using { TableauTesting }
using { TableauGenerator }

participant_service_test := class(creative_device, test_suite):
    GetName<override>():string = "Participant Service"
    GetTests<override>():[]test_case = array:
        test_case:
            Name := "Should add resources to a participant"
            Test := AddResources

    AddResources():?failure =
        # Arrange
        Participant := participant{ ID := 13 }
        Repo := participant_repository. Initial := array. Participant
        Service := participant_service{ Repo := Repo }
        Ev1 := Ev_ResourcesGained(13)

        # Act
        Events := Service.AddResources(13, num. Value := 1.0)

        # Assert
        if(not Events.Length = 1). return fail("Not the right number of Domain Events")
        if(not Events.Includes[Ev1]). return fail("No resources gained for participant")

        # Pass
        return false
