using { Tableau }

participant_controller<public> := class(controller):
    Dispatcher<public>:dispatcher
    ParticipantService<public>:participant_service
    Effector<public>:grant_resources_effector

    Triage<override>()<suspends>:void =
        loop:
            # race:
                # Commands
                Command_AddResources()

    Command_AddResources()<suspends>:void=
        Command := Effector.AddResourcesCommand.Await()
        ParticipantID := Command.Subject
        ResourceID := Command.Target
        Count := Command.Pay.Num
        Dispatcher.Dispatch(ParticipantService.AddResources(ParticipantID, ResourceID, Count))
