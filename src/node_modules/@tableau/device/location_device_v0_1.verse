
using. /Verse.org/Simulation
using. /Fortnite.com/Devices

using. Vertex

location_device_v0_1<public> := class(tableau_device):
    DeviceType<override>:string = "LOCATION"

    @editable X<public>:float_plug = float_plug{}
    @editable Y<public>:float_plug = float_plug{}
    @editable Z<public>:float_plug = float_plug{}
    @editable ScaleX<public>:float_plug = float_plug. Default := 512.0
    @editable ScaleY<public>:float_plug = float_plug. Default := 512.0
    @editable ScaleZ<public>:float_plug = float_plug. Default := 384.0
    @editable Prop<public>:?creative_prop = false
    @editable InitialX<public>:int = 0
    @editable InitialY<public>:int = 0
    @editable InitialZ<public>:int = 0

    GetResources<override>():[]resource= array. resource:
        Props := map:
            "X" => Float of X
            "Y" => Float of Y
            "Z" => Float of Z
            "X Scale" => Float of ScaleX
            "Y Scale" => Float of ScaleY
            "Z Scale" => Float of ScaleZ
            "X Coord" => Float of (Path("X"), "*", Path("X Scale"))
            "Y Coord" => Float of (Path("Y"), "*", Path("Y Scale"))
            "Z Coord" => Float of (Path("Z"), "*", Path("Z Scale"))
            "XY Location" => Vec2 of (Path("X Coord"), "Append", Path("Y Coord"))
            "Without Offset" => Vec3 of (Path("XY Location"), "Append", Path("Z Coord") )
            "Base Location" => Vec3 of if (P := Prop?). P.GetTransform().Translation else. V3()
            "Initial Location" => Vec3 of V3(InitialX * ScaleX.Default, InitialY * ScaleY.Default, InitialZ * ScaleZ.Default)
            "Offset" => Vec3 of (Path("Base Location"), "-", Path("Initial Location"))
            "Location" => Vec3 of (Path("Without Offset"), "+", Path("Offset") )
