
using. /Fortnite.com/Devices
using. /Verse.org/Simulation

using. Tableau

add_camera_fn := class():
    Agent:?agent
    Camera:gameplay_camera_device
    FN<public>(Value:logic):void= if (A := Agent?):
        if (Value?). Camera.AddTo(A) else. Camera.RemoveFrom(A)

toggle_camera_device<public> := class(creative_device, side_effect_device):
    @editable ResourceID:string = ""
    @editable PropertyID:string = ""
    @editable Camera:gameplay_camera_fixed_angle_device = gameplay_camera_fixed_angle_device{}

    GetResourceID<override>()<computes>:?string= option. ResourceID
    GetPerType<override>()<computes>:?string= false
    GetPerSubType<override>()<computes>:?string= option. "Player"
    GetSideEffects<override>(GameState:game_state, ResID:string, PlayerID:string)<suspends>:[]side_effect=
        Agent := GameState.GetAgentProp(PlayerID, "Possessed By", "").Get()
        AddCam := add_camera_fn{ Agent := Agent, Camera := Camera }
        array:
            PushBool(Path(PropertyID), AddCam.FN)
            # Debug(Path(PropertyID), "{ResourceID}.{PropertyID} Camera")
