
using { Tableau }

resource_vm<public> := class():
    ID<public>:int
    Name<public>:gooey_string := gooey_string{}
    var Properties<public>:[string]resource_property_vm = map{}

    Init<public>(Resource:resource)<suspends>:void =
        spawn. Name.Init(Resource.Name)
        for (Property:Resource.Properties):
            VM := resource_property_vm{ Default := "Test" }
            spawn. VM.Init(Property.Name)
            if:
                set Properties[Property.Name] = VM

resource_property_vm<public> := class():
    Name<public>:gooey_string := gooey_string{}
    Default<public>:string
    var Values<public>:[int]gooey_string := map{}

    Init<public>(PropertyName:string)<suspends>:void =
        spawn. Name.Init(PropertyName)

    ValueFor<public>(ParticipantID:int):gooey_string =
        if (Value := Values[ParticipantID]). return Value
        VM := gooey_string{}
        spawn. VM.Init(Default)
        if:
            set Values[ParticipantID] = VM

        return VM