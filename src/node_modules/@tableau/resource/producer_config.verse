
using { /Fortnite.com/Devices }
using { /Verse.org/Simulation }

using { Tableau }

producer_settings<public> := class<concrete>():
    @editable ID:string = ""
    @editable BaseCost:float = 3.738
    @editable CostGrowth:float = 1.07
    @editable CostResource:string = ""
    @editable Production:float = 1.67
    @editable ProductionRate:float = 0.6
    @editable ProduceResource:string = ""

CreateProducerResource<public><constructor>(Name:string, Production:float, ProductionRate:float, CostGrowth:float, BaseCost:float, CostResource:string, ProduceResource:string) := resource:
    ID := Name
    StatProps := props:
        Strs := array:
            prop_str{ ID := "Name", Default := Name }
        Floats := array:
            prop_float{ ID := "Cost Growth", Default := CostGrowth }
            prop_float{ ID := "Base Cost", Default := BaseCost }
            prop_float{ ID := "Production Rate", Default := ProductionRate }
    Props := props:
        Nums := array:
            prop_num{ ID := "Count", Default := num{} }
        Floats := array:
            prop_float{ ID := "Production", Default := Production }
    CompProps := comp_props:
        Nums := array:
            comp_num:
                ID := "Production Amount"
                BaseProp := "Count"
                Computer := computer{ FN := "Multiply", Pay := Load(Path(Name, "Production")) }
            comp_num:
                ID := "Cost Rate"
                BaseProp := "Cost Growth"
                Computer := computer{ FN := "Power", Pay := Load(Path(Name, "Count")) }
            comp_num:
                ID := "Cost"
                BaseProp := "Cost Rate"
                Computer := computer{ FN := "Multiply", Pay := Load(Path(Name, "Base Cost")) }
        Bools := array:
            comp_bool:
                ID := "Can Afford"
                BaseResource := CostResource
                BaseProp := "Count"
                Computer := computer{ FN := ">=", Pay := Load(Path("Cost")) }
            comp_bool:
                ID := "Has One"
                BaseResource := Name
                BaseProp := "Count"
                Computer := computer{ FN := "=", Pay := load. Float := 1.0 }
    Abilities := array:
        ability:
            ID := "Buy"
            Effects := array:
                effect{ FN := "Is True", Focus := option. Path("Can Afford") }
                effect{ FN := "Decrease", Focus := option. Path(CostResource, "Count"), Pay := Load(Path(Name, "Cost")) }
                effect{ FN := "Increase", Focus := option. Path("Count"), Pay := load. Float := 1.0 }
                effect{ FN := "Is True", Focus := option. Path("Has One") }
                effect{ FN := "Execute Ability", Focus := option. Path(Name, "Produce") }
        ability:
            ID := "Produce"
            Effects := array:
                effect{ FN := "Delay", Focus := option. Path(Name, "Production Rate") }
                effect{ FN := "Increase", Focus := option. Path(ProduceResource, "Count"), Pay := Load(Path(Name, "Production Amount")) }
                effect{ FN := "Execute Ability", Focus := option. Path(Name, "Produce") }

producer_config<public> := class(creative_device, config_device):
    @editable ProducerSettings<public>:[]producer_settings = array{}

    GetResources<override>():[]resource=
        for (P:ProducerSettings):
            CreateProducerResource(P.ID, P.Production, P.ProductionRate, P.CostGrowth, P.BaseCost, P.CostResource, P.ProduceResource)
