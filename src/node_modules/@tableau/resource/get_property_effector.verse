using { Tableau }

get_property_effector<public> := class(effector):
    GameState<public>:game_state

    Play<override>(Command:command, Payload:payload)<suspends>:command=
        ResourceID := Command.Subject
        ParticipantID := Command.Target
        PropertyID := Payload.Str

        if (GSResource := GameState.Resources[ResourceID]):
            PropType := GSResource.PropTypes[PropertyID] or prop_type.Unknown
            Value := case(PropType):
                prop_type.Num =>
                    if (Num := GSResource.Props.Nums[PropertyID]):
                        Num.ValueFor(ParticipantID).Get()
                    else. num. Value := Payload.Float
                prop_type.Float =>
                    FloatValue := if (Float := GSResource.Props.Floats[PropertyID]):
                        Float.ValueFor(ParticipantID).Get()
                    else. Payload.Float
                    num. Value := FloatValue
                _ => num. Value := Payload.Float

            return command:
                CopyCommand<constructor>(Command)
                Payload := payload. Num := Value

        return Command
