
using. /Verse.org/Simulation

using. Vertex

CreateContextualPropertyMap<public>(Context:context_collection_v0_1):[string]prop=
    CombineAll of array:
        map{ Context.Name => Str of Context.Context }
        CreateMap of for(Prop:Context.Properties). case(Prop.Type):
            prop_type.BoolType => (Prop.Rename? or Prop.Name, Bool of Path(Path(Context.Name), Prop.Name))
            prop_type.IntegerType => (Prop.Rename? or Prop.Name, Integer of Path(Path(Context.Name), Prop.Name))
            prop_type.FloatType => (Prop.Rename? or Prop.Name, Float of Path(Path(Context.Name), Prop.Name))
            prop_type.NumType => (Prop.Rename? or Prop.Name, Num of Path(Path(Context.Name), Prop.Name))
            prop_type.StrType => (Prop.Rename? or Prop.Name, Str of Path(Path(Context.Name), Prop.Name))
            prop_type.StrsType => (Prop.Rename? or Prop.Name, Strs of Path(Path(Context.Name), Prop.Name))
            prop_type.AgentType => (Prop.Rename? or Prop.Name, UEAgent of Path(Path(Context.Name), Prop.Name))
            prop_type.Vec2Type => (Prop.Rename? or Prop.Name, Vec2 of Path(Path(Context.Name), Prop.Name))
            prop_type.Vec3Type => (Prop.Rename? or Prop.Name, Vec3 of Path(Path(Context.Name), Prop.Name))
            _ => (Prop.Rename? or Prop.Name, Str of Path(Path(Context.Name), Prop.Name))

CreateContextualActionMap<public>(Context:context_collection_v0_1):[string]action=
    CreateMap of for(AID:Context.Actions). (AID, Action of (Path(Context.Name), AID))

ContextCollection<public><constructor>(Name:string, Context:str_plug, Properties:[]contextual_property_v0_1, Actions:[]string) := context_collection_v0_1{ Name := Name, Context := Context, Properties := Properties, Actions := Actions }
context_collection_v0_1<public> := class<concrete>():
    @editable Name<public>:string = "Context"
    @editable Context<public>:str_plug = str_plug{}
    @editable Properties<public>:[]contextual_property_v0_1 = array{}
    @editable Actions<public>:[]string = array{}

contextual_property_v0_1<public> := class<concrete>():
    @editable Name<public>:string = "Property Name"
    @editable Rename<public>:?string = false
    @editable Type<public>:prop_type = prop_type.StrType
