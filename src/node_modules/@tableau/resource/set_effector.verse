
using. Numb
using. Tableau

set_effector<public> := class(effector):
    GameState<public>:game_state

    Play<override>(Source:string, Activator:string, Focus:prop_path, Pay:load)<suspends>:?[]command=
        ActualPay := if (HalfPath := Pay.HalfPath?):
            PropPath := GameState.ResolvePath(Source, HalfPath, Activator)
            PropType := GameState.ResourceRepository.GetPropTypes[PropPath.ResourceID][PropPath.PropertyID] or prop_type.Unknown
            case(PropType):
                prop_type.Num =>
                    Value := GameState.GetNumProp(PropPath, Activator).Get()
                    load{ Num := Value }
                prop_type.Str =>
                    Value := GameState.GetStrProp(PropPath, Activator).Get()
                    load{ Str := Value }
                _ => load{}
        else. Pay

        option. array. command:
            Subject := Focus.ResourceID
            Target := Activator
            Property := Focus.PropertyID
            Pay := ActualPay
