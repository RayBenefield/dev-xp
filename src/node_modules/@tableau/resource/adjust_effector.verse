using { Tableau }

sign<public> := enum:
    Positive
    Negative

adjust_effector<public> := class(effector):
    GameState<public>:game_state
    Sign<public>:sign = sign.Positive

    Play<override>(Source:string, Activator:string, Focus:prop_path, Pay:load):?[]command=
        ResourceID := if (ID := Focus.ResourceID?). ID else. Source
        ParticipantID := Activator
        PropertyID := Focus.PropertyID
        StartingValue := GameState.GetNumProp(Source, Focus, ParticipantID).Latest
        ModifierValue := if (Prop := Pay.Prop?):
            VM := GameState.GetNumProp(Source, Prop, ParticipantID)
            Value := VM.Latest
            Value
        else. num. Value := Pay.Float
        SignValue := if (Sign = sign.Negative). -1 else. 1
        SignedModifier := ModifierValue * SignValue

        Command := command:
            Subject := ResourceID
            Target := ParticipantID
            Property := PropertyID
            Pay := load. Num := StartingValue + SignedModifier

        return option. array. Command
