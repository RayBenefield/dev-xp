import { firestore } from 'firebase-admin'

const { FieldValue } = firestore

export default ({ projectId, api, db }) => (samples, name) =>
    Promise.all([
        api.trainSamples(samples, name),
        db.upsert(`projects/${projectId}/training/${name || '-negative-'}`, {
            samples: FieldValue.arrayUnion(...samples),
        }),
    ])
