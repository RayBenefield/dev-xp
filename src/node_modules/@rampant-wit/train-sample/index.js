import { firestore } from 'firebase-admin'

const { FieldValue } = firestore

export default ({ projectId, api, db }) => (sample, name) =>
    Promise.all([
        api.samples([sample], name),
        name
            ? /* eslint-disable indent */
              db.update(`projects/${projectId}/training/${name}`, {
                  samples: FieldValue.arrayUnion(sample),
              })
            : db.update(`projects/${projectId}`, {
                  noIntentSamples: FieldValue.arrayUnion(sample),
              }),
    ])
