local expect, printed = require'rx-test'()
local rx, _ = require'rx'()

describe('MergeMap Operator', function()
    describe('mergeMap()', function()

        it('is included in rx object', function()
            assert.no.is_nil(_.mergeMap)
        end)

        it('maps with nothing is bypassed', function()
            local test_ = rx.of('hello').pipe(_.mergeMap())
            --
            expect(test_).to.produce('hello')
        end)

        it('handles single value', function()
            local test_ = rx.of('hello').pipe({
                _.mergeMap(function(val) return rx.of(val) end)
            })
            --
            expect(test_).to.produce('hello')
        end)

        it('handles multiple values', function()
            local test_ = rx.from({'world', 'folks', 'people'}).pipe({
                _.mergeMap(function(val) return rx.from({val, val}) end)
            })
            --
            expect(test_).to.produce('world', 'world', 'folks', 'folks', 'people', 'people')
        end)

    end)
end)
