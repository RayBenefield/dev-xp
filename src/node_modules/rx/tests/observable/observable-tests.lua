local expect, printed = require'rx-test'()
local rx, _ = require'rx'()

describe('Observable Basics', function()
    describe('subscribe()', function()

        it('accepts a basic table allowing for trailing commas', function()
            local test_ = rx.merge(rx.of('hello', 'roar'), rx.of('world'), rx.of('test'))
            --
            test_.subscribe({print, nil, print})
            printed(5)
        end)

        it('is hot by default', function()
            local test_ = rx.create(function(destination)
                destination.next(os.time())
            end).pipe(_.log())
            --
            test_.subscribe()
            test_.subscribe()
            printed(1)
        end)

        it('multicasts by default', function()
            local test_ = rx.NEVER
            --
            test_.pipe(_.log()).subscribe()
            test_.pipe(_.log()).subscribe()
            test_.shamefullySendNext('hello')
            printed(2)
        end)

    end)
end)
