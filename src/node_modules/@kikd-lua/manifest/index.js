import { resolve } from 'path'

import { sync as exists } from 'file-exists'

const cache = {}

export default ({ root, name, structure: { srcDir } }) => {
    if (name in cache) return cache[name]

    const rockspecJson = resolve(root, srcDir, 'rockspec.json')

    // eslint-disable-next-line global-require, import/no-dynamic-require
    const manifest = exists(rockspecJson) ? require(rockspecJson) : {}
    cache[name] = manifest

    return manifest
}
