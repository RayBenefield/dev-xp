import { resolve } from 'path'

import manifest from '@kikd-lua/manifest'

const type = 'lua-rock'

export const rockspecJson = (root, srcDir, files) =>
    files.includes('rockspec.json')
        ? // eslint-disable-next-line global-require, import/no-dynamic-require
          require(resolve(root, srcDir, 'rockspec.json'))
        : false

export default {
    type,
    manifest,
    filter: ({ root = '.', srcDir = '.', files = [] }) => {
        const manifestData = rockspecJson(root, srcDir, files)
        return manifestData
    },
}
