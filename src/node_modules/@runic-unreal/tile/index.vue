<template lang="pug">
.node
  .header
    i(v-if='node.symbol' :class="[...node.symbol, 'icon']")
    .name {{node.name}}
  .content
    .column(v-if='node.controls.size > 0 || node.inputs.size > 0')
      .inputs(v-for='input in inputs()')
        Socket(v-socket:input="input", type="input", :socket="input.socket", :used="input.connections.length > 0")
        .input-title(v-show='!input.showControl()') {{input.name}}
        .input-control(v-show='input.showControl()', v-control='input.control')
      .control(v-for='control in controls()',
        style='text-align: center',
        :style='{ width: control.parent.width - 2 * control.margin, height: control.height }',
        v-control='control'
        )
    .column
      .outputs(v-for='output in outputs()')
        .output-title {{output.name}}
        Socket(v-socket:output="output", type="output", :socket="output.socket", :used="output.connections.length > 0")
</template>

<script>
import Socket from '@runic-unreal/socket'
import VueRender from 'rete-vue-render-plugin'

export default {
    mixins: [VueRender.mixin],
    components: { Socket },
}
</script>

<style lang="sass" scoped>
$node-color: rgba(20,20,20,0.9)
$hover-color: rgba(35,35,35,0.7)
$color-active: darken($node-color,5%)
$title-light: rgba(0, 255, 0,0.5)
$title-light-transparent: rgba(0, 255, 0,0.0)
$group-color: rgba(15,80,255,0.2)
$group-handler-size: 40px
$group-handler-offset: -10px
$context-menu-round: 7px
$socket-size: 10px
$socket-margin: 10px

.node
    background: $node-color
    box-shadow: 1px solid black
    border: 2px solid rgba(0,0,0,.6)
    border-radius: 5px
    cursor: move
    display: inline-block
    height: auto
    box-shadow: 4px 5px 9px rgba(0,0,0,0.5)
    &:hover
        background: $hover-color
    &.active
        background: $color-active
        border: 1px solid #ffd252
    .header
        border-top: 1px solid rgba(204, 204, 204, .7)
        color: white
        border-radius: 3px 3px 0px 0px
        padding-top: 1px
        padding-right: 1px
        padding-bottom: 1x
        padding-left: 8px
        overflow: hidden
        line-height: 22px
        background: linear-gradient(to right,rgba(170,238,160,.4) 0,rgba(170,238,160,.1) 100%)
    .name
        display: inline
        text-align: left
        font-weight: 500
        font-family: Roboto, sans-serif
        margin-left: 2px
        margin-right: 20px
    .icon
        margin: 0px 4px
        color: rgba(170,238,160,1)
    .content
        min-height: 32px
        color: white
        font-weight: 300
        font-size: 12px
        font-family: sans-serif
        font-size: 14px
        display: table
        width: 100%
        .column
            box-sizing: border-box
            display: table-cell
            white-space: nowrap
            &:not(:last-child)
                padding-right: 20px
        .inputs
            text-align: left
        .outputs
            text-align: right
            height: 24px
        .input-title,.output-title
            vertical-align: middle
            display: inline-block
            margin: $socket-margin 0
            line-height: $socket-size
        .input-control
            z-index: 1
            vertical-align: middle
            display: inline-block
        .control
            width: 100%
            padding: $socket-margin $socket-size/2 + $socket-margin
</style>
