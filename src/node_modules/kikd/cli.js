import { configure } from 'kli'
import 'loud-rejection/register'

import style from '@kikd/cli-style'

import { command as changes } from '@semcom/command-changes'
import { command as version } from '@semcom/command-version'
import { command as prerelease } from '@semcom/command-prerelease'

import { command as deps } from '@kikd/command-deps'
import { command as list } from '@kikd/command-list'
import { command as build } from '@kikd/command-build'
import { command as check } from '@kikd/command-check'
import { command as publish } from '@kikd/command-publish'

const { CI } = process.env
const kli = configure({ defaultStyle: CI ? {} : style })

const cli = kli({
    commands: [
        build(),
        changes(),
        check(),
        deps(),
        list(),
        prerelease(),
        publish(),
        version(),
    ],
})

cli.execute(process.argv.slice(2))
