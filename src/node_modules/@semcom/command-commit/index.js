import transmute from 'transmutation'
import gitStatus from '@semcom/git-status'
import resetVsAdd from '@semcom/reset-vs-add'
import requestCommit from '@semcom/request-commit'

export default function status() {
    return transmute({})
        .extend('statusFiles', gitStatus)
        .extend('filesToCommit', ({ statusFiles }) =>
            requestCommit(statusFiles)
        )
        .extend('resetVsAdd', ({ statusFiles, filesToCommit }) =>
            resetVsAdd({ statusFiles, filesToCommit })
        )
}

export const command = () => ({
    name: 'commit',
    aliases: ['ci'],
    run: status,
})
