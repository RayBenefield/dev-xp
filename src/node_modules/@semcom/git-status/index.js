import { silent as git } from '@dev-xp/git'
import merge from '@transmutation/merging-function'

export default () =>
    git.status().then(({ files = [] } = {}) =>
        files.reduce((statuses, { path, index, working_dir: working }) => {
            if (index === '?' && working === '?')
                return merge(statuses, { untracked: [path] })

            if (index === 'M' && working === ' ')
                return merge(statuses, { staged: [path] })

            if (index === ' ' && working === 'M')
                return merge(statuses, { modified: [path] })

            return statuses
        }, {})
    )
