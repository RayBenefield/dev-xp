import { relative, sep } from 'path'

import * as R from 'ramda'

const first = R.nth(0)

const underSrcDir = R.curry(relative)('src/node_modules/')
const partsOfPath = R.split(sep)
const isScoped = R.pipe(first, R.startsWith('@'))
const toScopedName = R.pipe(R.slice(0, 2), R.join('/'))
const decideScope = R.ifElse(isScoped, toScopedName, first)
const getPackageName = R.pipe(underSrcDir, partsOfPath, decideScope)

const packageScope = R.when(R.contains('src/node_modules/'), getPackageName)
const toScope = R.either(packageScope, R.identity)

export default files => files.map(toScope)
