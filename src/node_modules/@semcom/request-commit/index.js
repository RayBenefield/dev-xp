import { prompt, Separator } from 'inquirer'
import { yellow, cyan, red, green } from 'chalk'

// eslint-disable-next-line complexity
export default ({
    staged = [],
    modified = [],
    partial = [],
    untracked = [],
}) => {
    let choices = []

    const tag = (file, conflict) =>
        conflict ? ` ${yellow.bold('[PARTIAL]')} ${file}` : ` ${file}`

    const stagedFile = (conflict = false) => file => ({
        name: tag(green(file), conflict),
        value: conflict ? { status: 'staged', file } : file,
        checked: true,
    })
    const modifiedFile = (conflict = false) => file => ({
        name: tag(red(file), conflict),
        value: conflict ? { status: 'modified', file } : file,
    })

    if (staged.length > 0 || partial.length > 0) {
        choices = choices.concat([
            new Separator('---Staged Files-----'),
            ...staged.map(stagedFile()),
            ...partial.map(stagedFile(true)),
        ])
    }

    if (modified.length > 0 || partial.length > 0) {
        choices = choices.concat([
            new Separator('---Modified Files---'),
            ...modified.map(modifiedFile()),
            ...partial.map(modifiedFile(true)),
        ])
    }

    if (untracked.length > 0) {
        choices = choices.concat([
            new Separator('---Untracked Files--'),
            ...untracked.map(file => ({
                name: ` ${cyan(file)}`,
                value: file,
            })),
        ])
    }

    return prompt([
        {
            type: 'checkbox',
            name: 'filesToCommit',
            message: 'What files will we commit?',
            choices,
        },
    ]).then(({ filesToCommit }) => filesToCommit)
}
