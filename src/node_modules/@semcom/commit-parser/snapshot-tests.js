import describe from 'kape'
import dedent from 'dedent'
import parser from '@semcom/commit-parser'

describe('Commit Parser', parser, snapshot => {
    snapshot(
        [],
        [{ commits: [] }],
        [
            {
                commits: [
                    { hash: '1', message: 'test' },
                    { hash: '2', message: 'false' },
                    { hash: '3', message: 'roar' },
                    { hash: '4', message: 'not work' },
                ],
            },
        ],
        [
            {
                commits: [
                    {
                        hash: '1',
                        message: 'dx(quality): not sentence cased.',
                    },
                    {
                        hash: '2',
                        message: 'FEAT(scope): No all caps type.',
                    },
                    { hash: '3', message: 'fix(test) No colon.' },
                    {
                        hash: '4',
                        message: 'fix[test]: Brackets instead of parens.',
                    },
                    {
                        hash: '5',
                        message:
                            'fix(*, nope): Do not allow asterisk with other scopes.',
                    },
                ],
            },
        ],
        [
            {
                commits: [
                    {
                        hash: '1',
                        message: 'dx(quality): Message to play.',
                    },
                    {
                        hash: '2',
                        message: 'feat(scope): Dude messages.',
                    },
                    {
                        hash: '3',
                        message: 'fix(test): Blah of a message.',
                    },
                    {
                        hash: '4',
                        message: 'fix(multiple, scopes): Blah of a message.',
                    },
                    { hash: '5', message: 'fix(*): Blah of a message.' },
                ],
            },
        ],
        [
            {
                commits: [
                    {
                        hash: '1',
                        message: dedent`
                            dx(quality): Message to play.

                            Some body message.
                            `,
                    },
                    {
                        hash: '2',
                        message: dedent`
                            feat(scope): Dude messages.

                            The Best body that is multiple lines of stuff
                            like so... as you can see. It is a thing.
                            `,
                    },
                    {
                        hash: '3',
                        message: dedent`
                            fix(test): Blah of a message.
                            This body is right after the header.
                            `,
                    },
                    {
                        hash: '4',
                        message: dedent`
                            fix(multiple, scopes): Blah of a message.
                            And this one is also multiple lines as well
                            as being directly under the header.
                            `,
                    },
                ],
            },
        ],
        [
            {
                commits: [
                    {
                        hash: '1',
                        message: dedent`
                            dx(quality): First of multiple headers.

                            Some body message.

                            feat(scope): Second of them.

                            The Best body that is multiple lines of stuff
                            like so... as you can see. It is a thing.
                            `,
                    },
                    {
                        hash: '2',
                        message: dedent`
                            fix(test): First.
                            This body is right after the header.
                            fix(multiple, scopes): Second with multi-scopes.
                            And this one is also multiple lines as well
                            as being directly under the header.
                            `,
                    },
                ],
            },
        ],
        [
            {
                commits: [
                    {
                        hash: '1',
                        message: dedent`
                            dx(quality): Message to play.

                            First part of main body.

                            Second part of body.

                            fix(test): Second effect.
                            `,
                    },
                ],
            },
        ],
        [
            {
                commits: [
                    {
                        hash: '1',
                        message: dedent`
                            Start with a body.

                            fix(test): Should be considered separate "commit" from body.
                            `,
                    },
                ],
            },
        ]
    )
})
