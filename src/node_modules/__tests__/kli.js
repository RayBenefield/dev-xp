import withBlueTape from 'blue-tape';
import describe from 'tape-bdd';
import kli from 'kli';

describe(
    'KLI',
    it => {
        it('should error when no commands are given', assert =>
            assert.throws(() => kli(), 'No commands defined'));

        it('should error when commands is not an array', assert =>
            assert.throws(
                () => kli({ commands: {} }),
                'Commands must be an array',
            ));

        it('should have an execute command', assert => {
            const cli = kli({
                commands: [
                    {
                        name: 'test',
                        run: () => {},
                    },
                ],
            });
            assert.ok(cli.execute);
        });

        it('should run test command', assert => {
            const cli = kli({
                commands: [
                    {
                        name: 'test',
                        run: () => assert.pass(),
                    },
                ],
            });
            cli.execute();
        });

        it('should error if any command does not have a run method', assert =>
            assert.throws(
                () =>
                    kli({
                        commands: [
                            {
                                name: 'test',
                            },
                        ],
                    }),
                'All commands must have a run method',
            ));
    },
    withBlueTape,
);
