import configure from '@kli-tool/executor';
import describe from 'tape-bdd';
import 'loud-rejection/register';
import withBlueTape from 'blue-tape';

const searcher = command => ({
    searcher: {
        get: () => [command],
    },
    defaultRenderer: () => {},
});

describe(
    'KLI Executor',
    it => {
        it('run the searched command', assert => {
            const executor = configure(
                searcher({
                    run: () => assert.pass(),
                }),
            );
            executor(['test']);
        });

        it('should run a promise based command', assert => {
            const executor = configure(
                searcher({
                    run: () => new Promise(res => res(assert.pass())),
                }),
            );
            executor(['test']);
        });

        it('should send results of command to a renderer', assert => {
            const executor = configure({
                ...searcher({
                    run: () => 'pass',
                }),
                defaultRenderer: result => assert.equal(result, 'pass'),
            });
            executor(['test']);
        });
    },
    withBlueTape,
);
