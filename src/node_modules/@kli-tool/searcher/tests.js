import searcher from '@kli-tool/searcher'
import describe from '@kikd/tape'

describe('KLI Searcher', it => {
    it('allow searching by name', assert => {
        const command = searcher({
            commands: [
                {
                    name: 'command',
                },
            ],
        }).get('command')[0]
        assert.equals(command.name, 'command')
    })

    it('allow searching by a short name', assert => {
        const command = searcher({
            commands: [
                {
                    name: 'command',
                },
            ],
        }).get('com')[0]
        assert.equals(command.name, 'command')
    })

    it('allow searching by an alias', assert => {
        const command = searcher({
            commands: [
                {
                    name: 'command',
                    aliases: 'test',
                },
            ],
        }).get('test')[0]
        assert.equals(command.name, 'command')
    })

    it('allow searching by a short alias', assert => {
        const command = searcher({
            commands: [
                {
                    name: 'command',
                    aliases: 'test',
                },
            ],
        }).get('t')[0]
        assert.equals(command.name, 'command')
    })

    it('allow searching by an array of aliases', assert => {
        const command = searcher({
            commands: [
                {
                    name: 'command',
                    aliases: ['test'],
                },
            ],
        }).get('test')[0]
        assert.equals(command.name, 'command')
    })

    it('allow searching by a name even with aliases', assert => {
        const command = searcher({
            commands: [
                {
                    name: 'command',
                    aliases: ['test'],
                },
            ],
        }).get('command')[0]
        assert.equals(command.name, 'command')
    })

    it('ensure searching for all aliases and names are the same', assert => {
        const subject = searcher({
            commands: [
                {
                    name: 'command',
                    aliases: ['test', 'another'],
                },
            ],
        })
        const name = subject.get('command')[0]
        const alias1 = subject.get('test')[0]
        const alias2 = subject.get('another')[0]
        assert.ok(name === alias1 && alias1 === alias2 && alias2 === name)
    })
})
