import log from '@dev-xp/log'
import * as _ from '@dev-xp/utils'
import boundingBox from '@sigils/nodes-bounding-box'

export default (editor, maybeNodes = editor.nodes) => {
    const nodes = _.isEmpty(maybeNodes) ? editor.nodes : maybeNodes
    const bbox = boundingBox(editor, nodes)
    const [x, y] = bbox.getCenter()
    const [w, h] = [
        editor.view.container.clientWidth,
        editor.view.container.clientHeight,
    ]
    const { area } = editor.view

    const [kw, kh] = [w / bbox.width, h / bbox.height]
    const k = Math.min(kh * 0.9, kw * 0.9, 1)

    area.transform.x = area.container.clientWidth / 2 - x * k
    area.transform.y = area.container.clientHeight / 2 - y * k
    area.zoom(k, 0, 0)

    area.update()
}
