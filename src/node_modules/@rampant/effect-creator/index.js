import get from '@rampant/get'
import { tap } from 'rxjs/operators'

export default ({ db }) => effect => {
    if (effect.db) {
        const { type = 'upsert', doc, data } = effect.db
        return tap(({ context }) => {
            const key = get(context, doc)
            const value = get(context, data)

            db[type](`projects/testing/custom-db/${key}`, value)
        })
    }

    if (effect.log)
        // eslint-disable-next-line no-console
        return tap(({ context }) => console.log(get(context, effect.log)))

    return tap()
}
