/* eslint-disable no-console */
import { db } from '@rampant/ai/cli.js'
import { white, underline } from 'chalk'
import serial from '@rampant/serial-promise'
import { intents, cleanupDocs } from '@rampant/ai/test-intents.js'

const createIntents = () => {
    console.log()
    console.log(`  ${white(underline('Intent Tests'))}`)
    console.log()

    return Promise.all(
        intents.map(intent =>
            db.set(`projects/testing/intents/${intent.name}`, intent)
        )
    )
}

const cleanup = () => {
    console.log()

    return Promise.all([
        ...intents.map(({ name }) =>
            db.remove(`projects/testing/intents/${name}`)
        ),
        ...cleanupDocs.map(doc =>
            db.remove(`projects/testing/custom-db/${doc}`)
        ),
    ])
}

serial([createIntents, cleanup], 1000).then(() => process.exit(0))
