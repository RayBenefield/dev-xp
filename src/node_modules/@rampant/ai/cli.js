import { of, from, merge } from 'rxjs'
import { mergeMap } from 'rxjs/operators'

from([
    {
        name: 'test',
        sources: [{}],
        effects: [{ log: 'works' }],
    },
])
    .pipe(
        mergeMap(intent => {
            const sources = intent.sources.map(() => {
                const payload = { intent: intent.name }
                return of({
                    ...payload,
                    context: { source: { type: 'blank' } },
                })
            })
            return merge(...sources)
        })
    )
    .subscribe(console.log)
