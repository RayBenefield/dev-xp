import { of, merge } from 'rxjs'
import { tap } from 'rxjs/operators'

export default intent => {
    const sources = intent.sources.map(() => {
        const payload = { intent: intent.name }
        return of({
            ...payload,
            context: { source: { type: 'blank' } },
        })
    })
    const effects = intent.effects.map(effect => {
        // eslint-disable-next-line no-console
        if (effect.log) return tap(console.log(effect.log))
        return tap()
    })
    return merge(...sources).pipe(...effects)
}
