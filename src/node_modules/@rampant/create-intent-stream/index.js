import { merge } from 'rxjs'
import { tap } from 'rxjs/operators'
import createSources from '@rampant/source-creator'

export default intent => {
    const sources = intent.sources.map(createSources(intent))
    const effects = intent.effects.map(effect => {
        // eslint-disable-next-line no-console
        if (effect.log) return tap(console.log(effect.log))
        return tap()
    })
    return merge(...sources).pipe(...effects)
}
