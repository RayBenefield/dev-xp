import { of } from 'rxjs'
import { filter } from 'rxjs/operators'

export default ({ intent, db }) => source => {
    const payload = { intent: intent.name }

    if (source.db)
        return (
            db
                // TODO: Replace `testing` with Project ID
                .onDocumentChange(`projects/testing/custom-db/${source.db}`)
                .pipe(filter(_ => _))
        )

    return of({
        ...payload,
        context: { source: { type: 'blank' } },
    })
}
