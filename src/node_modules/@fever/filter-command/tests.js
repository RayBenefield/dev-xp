import describe from '@kikd/tape'
import filterCommand from '@fever/filter-command'

describe('Command Filter', it => {
    it('allow all messages with no filters', assert => {
        const filter = filterCommand()
        const result = filter({})
        assert.equals(result, true)
    })

    it('allow only streamer messages with streamer filter', assert => {
        const filter = filterCommand({ streamer: true })
        const result = filter({ userRoles: ['Owner'] })
        assert.equals(result, true)
    })

    it('filter non-streamer messages with streamer filter', assert => {
        const filter = filterCommand({ streamer: true })
        const result = filter({ userRoles: ['User'] })
        assert.equals(result, false)
    })

    it('allow user messages with user filter', assert => {
        const filter = filterCommand({ user: 'Bob' })
        const result = filter({ userName: 'Bob' })
        assert.equals(result, true)
    })

    it('filter wrong user messages with user filter', assert => {
        const filter = filterCommand({ user: 'Bob' })
        const result = filter({ userName: 'Bill' })
        assert.equals(result, false)
    })
})
