import '@dev-xp/config'
import createDb from '@rampant/db'
// import weekOf from '@rampant-giveaway/week-of'
import { createLogger } from '@rampant/logger'
import createTwitchRest from '@rampant-twitch/rest'
// import selection from '@rampant-giveaway/selection'

const {
    TWITCH_CLIENT_ID: clientId,
    TWITCH_CLIENT_SECRET: clientSecret,
    DATABASE_ID: dbId,
    LOG_LEVEL,
    STREAMER_ID: userId,
} = process.env

const logger = createLogger({ level: LOG_LEVEL })
const db = createDb({ id: dbId, logger })
const twitchRestCreator = createTwitchRest({ clientId, clientSecret, db })
twitchRestCreator(userId).then(rayTwitch =>
    rayTwitch.helix.users
        .getMe(true)
        .then(console.log)
        .then(() => console.log('done'))
)

/*
const mixerChat = createMixerChat({ clientId, db })
mixerChat({ channelId, userId }).then(moderator => {
    logger.platform(`Chat setup for [${channelId}] as [${userId}]`)

    const monday = weekOf(new Date(), 0)
    const week = `${monday.getFullYear()}-${monday.getMonth() +
        1}-${monday.getDate()}`
    logger.platform(`Collecting entries for the week of: ${week}`)
    selection({ prefix: week, db, moderator, logger })
})
*/
