local create = require('rx.observable.create')
local EMPTY = require('rx.observable.empty')

return function(values, keys)
    if (type(values) ~= table and #values <= 0) then
        return EMPTY
    end

    return create(function(destination)
        for key, value in pairs(values) do
            if (not keys) then
                destination.next(value)
            else
                destination.next(value, key)
            end
        end

        destination.complete()
    end)
end
