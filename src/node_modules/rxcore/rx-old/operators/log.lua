local util = require('util')
local create = require('rx.observable.create')

return function(prefix)
    return function(source)
        return create(function(destination)
            source.subscribe(
                function(...)
                    local args = {...}
                    if (type(args[1]) == 'table') then
                        local tbl = args[1]
                        util.printTable(tbl)
                        return destination.next(...)
                    end
                    print(prefix or '', ...)
                    destination.next(...)
                end,
                destination.err,
                destination.complete
            )
        end)
    end
end
