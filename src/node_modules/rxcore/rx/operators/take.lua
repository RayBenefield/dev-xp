local create = require('rx.observable.create')
local EMPTY = require('rx.observable.empty')

return function(count)
    if (not count) then
        return false
    end

    if (count <= 0) then
        return function() return EMPTY end
    end

    return function(source, destination)
        local seen = 0
        source.subscribe(
            function(...)
                destination.next(...)
                seen = seen + 1

                if (seen >= count) then
                    destination.complete()
                end
            end,
            destination.error,
            destination.complete
        )
        return function()
            destination.complete()
        end
    end
end
