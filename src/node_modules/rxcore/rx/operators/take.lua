local create = require('rx.observable.create')
local EMPTY = require('rx.observable.empty')

return function(count)
    if (not count) then
        return false
    end

    if (count <= 0) then
        return function(source)
            return create(function(destination)
                destination.complete()
            end)
        end
    end

    return function(source)
        return create(function(destination)
            local seen = 0
            local next = function(...)
                destination.next(...)
                seen = seen + 1

                if (seen >= count) then
                    destination.complete()
                end
            end
            source.subscribe(next)
        end)
    end
end
