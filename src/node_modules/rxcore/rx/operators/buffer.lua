local create = require('rx.observable.create')

return function(size)
    return function(source)
        local buffer = {}
        return create(function(destination)
            local seen = 0
            local next = function(val)
                table.insert(buffer, val)
                if (#buffer >= size) then
                    destination.next(buffer)
                    buffer = {}
                end
            end
            source.subscribe(next)
        end)
    end
end
