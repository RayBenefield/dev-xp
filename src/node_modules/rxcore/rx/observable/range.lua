local util = require('util')
local observable = require('rx.observable')

return function(start, stop, increment, inclusive)
    increment = util.isTrue(increment) and increment or 1
    local include = inclusive and (increment > 0 and 1 or -1) or 0
    stop = stop + include

    return observable(function(destination)
        local next = start
        local check = increment > 0
            and function(val) return val < stop end
            or function(val) return val > stop end

        while (check(next)) do
            destination.next(next)
            next = next + increment
        end

        destination.complete()
    end)
end
