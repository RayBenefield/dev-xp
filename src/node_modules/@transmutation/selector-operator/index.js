import { has } from 'lodash'
import * as _ from '@dev-xp/utils'

export default (path, branches) => value => {
    const test = _.getProp(path, value)
    if (has(branches, test)) return branches[test](value)
    // eslint-disable-next-line dot-notation
    if (has(branches, '_default')) return branches['_default'](value)
    return Promise.resolve(value)
}
