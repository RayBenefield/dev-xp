import describe from 'kape'
import extendEach from '@transmutation/extend-each'

const test = (snowball, key, target, map) =>
    extendEach(key, target, map)(snowball)
const base = {
    top: { structures: { one: 'four', two: 'five', three: 'six' } },
    fields: ['roar', 'test'],
}

describe('Extend Each Operator', test, snapshot => {
    snapshot('transmute().extendEach normal', [
        [base, 'configs', 'top', _ => `y${JSON.stringify(_)}`],
        [base, 'configs', 'top.structures', _ => `y${JSON.stringify(_)}`],
        [base, 'top.configs', 'top.structures', _ => `y${JSON.stringify(_)}`],
        [base, 'fields', _ => ({ [_]: true })],
    ])

    snapshot('transmute().extendEach w/ data/key', [
        [
            base,
            'configs',
            'top.structures',
            (v, data, k) => `${data.top.structures[k]} -> configs.${k}`,
        ],
        [
            base,
            'newFields',
            'fields',
            (v, data, k) => `${data.fields[k]} -> configs.${k}`,
        ],
        [base, 'newFields', 'fields', (v, data, k) => [k, v]],
    ])
})
