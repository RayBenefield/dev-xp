import log from '@dev-xp/log'
import { get, has, set } from 'lodash'
import merger from '@transmutation/merging-function'

export default (...args) => {
    const fn = path => value => {
        if (!Array.isArray(path)) return get(value, path)
        if (path.length === 0) return value

        return path.reduce((result, currentPath) => {
            if (has(value, currentPath)) {
                return merger(
                    result,
                    set({}, currentPath, get(value, currentPath))
                )
            }
            return result
        }, {})
    }
    if (args.length === 1) return fn(args[0])
    return fn(args[0])(args[1])
}
