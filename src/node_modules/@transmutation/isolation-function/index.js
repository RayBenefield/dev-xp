import log from '@dev-xp/log'
import { has } from 'lodash'
import * as _ from '@dev-xp/utils'
import merger from '@transmutation/merging-function'

export default (...args) => {
    const fn = path => value => {
        if (!Array.isArray(path)) return _.getProp(path, value)
        if (path.length === 0) return value

        return path.reduce((result, currentPath) => {
            if (has(value, currentPath)) {
                return merger(
                    result,
                    _.setProp(currentPath, _.getProp(currentPath, value), {})
                )
            }
            return result
        }, {})
    }
    if (args.length === 1) return fn(args[0])
    return fn(args[0])(args[1])
}
