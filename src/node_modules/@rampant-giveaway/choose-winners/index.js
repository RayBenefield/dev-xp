import weighted from 'weighted'
import mapValues from 'lodash.mapvalues'

export default entrants => {
    const weights = mapValues(entrants, ({ weight = 1 } = {}) =>
        Math.ceil(weight)
    )
    const winner = weighted.select(weights)
    const total = (all, { entries = 0 }) => entries + all

    return [
        {
            ...entrants[winner],
            candidates: Object.keys(entrants).length,
            allEntries: Object.values(entrants).reduce(total, 0),
        },
    ]
}
