import log from '@dev-xp/log'
import * as _ from '@dev-xp/utils'
import createComponent from '@runic/create-component'
import numberComponent from '@runic/number-component'
import constComponent from '@runic/const-component'

const types = {
    number: (readonly, bind) => (emitter, key) =>
        createComponent(key, control => ({
            component: numberComponent,
            props: { emitter, ikey: bind || key, readonly },
            setValue: val => {
                control.vueContext.value = val
            },
        })),
    const: (value, visible) => (emitter, key) =>
        createComponent(key, () => ({
            component: constComponent,
            props: { value, emitter, ikey: key, visible },
        })),
}

export default _.mapObjIndexed(
    (create, componentName) => (...args) => ({
        name: componentName,
        type: 'component',
        create: create(...args),
    }),
    types
)
