import collapse from '@kikd/collapse'

export default ({ plugins }) => ({
    root = '.',
    packageNames = [],
    types = {},
    structures = {},
}) =>
    packageNames
        .map(
            name =>
                types[name] !== 'unknown'
                    ? /* eslint-disable indent */
                      {
                          [name]:
                              plugins[types[name]].manifest({
                                  root,
                                  structure: structures[name],
                                  name,
                              }) || {},
                      }
                    : { [name]: {} }
        )
        .reduce(collapse, {})
