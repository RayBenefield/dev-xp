import * as _ from '@dev-xp/utils'
import * as log from '@dev-xp/log'

export default ({ plug }) => ({
    root = '.',
    packageNames = [],
    types = {},
    structures = {},
}) =>
    Promise.all(
        _.map(name => {
            const promise = plug('manifest')({
                type: types[name],
                root,
                name,
                structure: structures[name],
            })
            return Promise.resolve(promise).then(manifest => ({
                [name]: manifest,
            }))
        }, packageNames)
    ).then(_.mergeAll)
