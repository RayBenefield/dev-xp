import collapse from '@kikd/collapse'

export default ({ plugins = {} }) => ({
    packageNames = [],
    baseConfig,
    dependencies,
    structures,
    manifests,
    types,
} = {}) =>
    packageNames
        .map(
            name =>
                types[name] !== 'unknown'
                    ? /* eslint-disable indent */
                      {
                          [name]:
                              plugins[types[name]].config({
                                  baseConfig,
                                  dependencies: dependencies[name],
                                  structure: structures[name],
                                  manifest: manifests[name],
                              }) || {},
                      }
                    : { [name]: {} }
        )
        .reduce(collapse, {})
