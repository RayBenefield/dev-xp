/* eslint-disable no-console */
import execa from 'execa';
import npm from 'npm-utils';
import { resolve } from 'path';
import registryUrl from 'registry-url';

export default ({ root }) => {
    process.chdir(root);
    return npm.setAuthToken().then(() => {
        process.chdir(resolve(root, 'dist', 'kikd'));
        console.log(`Publishing [kikd]...`);
        return execa('npm', ['publish', '--registry', registryUrl()])
            .then(result => console.log(result.stdout))
            .catch(console.log);
    });
};
