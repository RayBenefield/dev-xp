const testChecks = pkgChecks =>
    Object.entries(pkgChecks)
        .filter(([check]) => check !== 'publishable')
        .map(([check, result]) =>
            result
                ? `<check><success>${check}</success></check>`
                : `<check><fail>${check}</fail></check>`
        )
        .join('')

const publishableCheck = publishable =>
    publishable
        ? '<success>publishable</success>'
        : '<fail>not publishable</fail>'

const formatPackage = ([name, pkgChecks]) => `<item>
    <title>${name}</title>
    ${testChecks(pkgChecks)}
    <check>${Array(23).join('â”€')}</check>
    <check>${publishableCheck(pkgChecks.publishable)}</check>
</item>`

const rootChecks = checks =>
    Object.entries(checks.root)
        .map(([check, result]) =>
            result
                ? `<check><success>${check}</success></check>`
                : `<check><fail>${check}</fail></check>`
        )
        .join('')

export default () => ({ checks }) => `
    <bar>-</bar>
    <h1>Checked Packages</h1>
    <bar>-</bar>
    <list>
        ${Object.entries(checks.packages).map(formatPackage).join('')}
    </list>
    <bar>-</bar>
    <title>Repository</title>
    ${rootChecks(checks)}
`
