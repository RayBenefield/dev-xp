# Get Javascript Package Details

Here we get the manifest details of a package which is stored in a
`package.json` file.

---

## Dependencies

We need `lodash.pick` to just extract some properties from a config file that
matter. `path.resolve` is used to make sure we get the absolute path of the
`package.json`. And `file-exists` is used to confirm a `package.json` exists to
avoid random errors.

```js
import pick from 'lodash.pick'
import { resolve } from 'path'
import { sync as exists } from 'file-exists'
```

---

## Logic

### Cache

This could be called multiple times within a single command's life cycle and we
want to make that as efficient as possible so we setup a cache to store details
as soon as we have them.

```js
const cache = {}
```

### Detail Fetching

We start by accepting the repository's `root`, the project's `name`, and the
actual `srcDir` to be used to hunt down the `package.json`. We use the name to
store things in the `cache`. If the `config` already exists in the `cache` then
we call it good.

```js
export default ({ root, name, structure: { srcDir } }) => {
    if (name in cache) return cache[name]
```

We need to grab the relevant manifest details for the package as it typically
contains important information for building, publishing, etc. We also extract
the key portions and through it in the root of the details.

```js
const packageJson = resolve(root, srcDir, 'package.json')
// eslint-disable-next-line global-require, import/no-dynamic-require
const manifest = exists(packageJson) ? require(packageJson) : {}
```

With everything gathered we structure the results and then cache it and return
it.

```js
    cache[name] = manifest
    return manifest
}
```
