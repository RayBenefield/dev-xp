/* eslint max-lines: ['warn', { max: 52, skipBlankLines: true }] */
/* eslint-disable no-console */
import { join } from 'path'
import { writeFileSync as writeFile } from 'fs'

import mkdir from '@dev-xp/mkdir'
import { prompt } from 'inquirer'

export const preCreate = ({ name, packagePath }) =>
    prompt([
        {
            type: 'editor',
            name: 'indexContents',
            message: 'What should the initial contents be for the index be?',
            default: `export default () => console.log('${name}')`,
        },
    ]).then(({ indexContents }) => ({
        indexPath: join(packagePath, 'index.js'),
        indexContents,
    }))

export const createTemplate = ({ indexPath }) => `
    <attr><key>Index Path:</key><value>${indexPath}</value></attr>
`

export default ({
    packagePath,
    extra: { indexPath, indexContents } = {},
} = {}) => {
    mkdir(packagePath)
    writeFile(indexPath, indexContents)
}
