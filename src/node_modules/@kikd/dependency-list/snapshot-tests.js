import describe from 'kape'
import list from '@kikd/dependency-list'

const packageNames = ['kikd', '@kikd/first', '@kikd/second', '@kikd/third']
const structures = {
    kikd: {
        srcDir: './src/node_modules/kikd',
        files: ['cli.js', 'package.json'],
    },
    '@kikd/first': {
        srcDir: './src/node_modules/@kikd/first',
        files: ['index.js', 'package.json'],
    },
    '@kikd/second': {
        srcDir: './src/node_modules/@kikd/second',
        files: ['index.js', 'package.json'],
    },
    '@kikd/third': {
        srcDir: './src/node_modules/@kikd/third',
        files: ['source.js', 'package.json'],
    },
}
const manifests = {
    kikd: {
        bin: {
            kd: 'cli.js',
        },
    },
    '@kikd/first': {},
    '@kikd/second': {},
    '@kikd/third': {
        main: 'source.js',
    },
}

describe('Dependency List', list, snapshot => {
    process.chdir(__dirname)

    snapshot(
        [],
        [{ root: '.' }],
        [{ root: '.', packages: ['roar'] }],
        [
            {
                root: './fixtures',
                packageNames,
                structures,
                manifests,
            },
        ]
        /* ---Real dependencies---
        [
            {
                root: resolve(__dirname, '../../'),
                packages: [
                    { name: 'kikd' },
                    { name: 'kli' },
                    { name: 'kape' },
                ],
            },
        ],
        */
    )
})
