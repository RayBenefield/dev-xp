
using. /Verse.org/Assets
using. /Verse.org/Simulation
using. /Fortnite.com/Devices
using. /UnrealEngine.com/Temporary/SpatialMath

using. TheDoctorAssets.Materials
using. Tableau
using. Vertex

CreateSlotResource<constructor>(Offset:vector3, GridSize:float, MaxX:int, MaxY:int) := resource:
    Type := "Slot"
    Props := map:
        "Slot Number" => Integer of (Path("Index"), "+", ONE())
        "Item Type" => Str of (Path("Inventory", "Items"), "Get", Path("Slot Number"))
        "Offset" => Vec3 of Offset
        "Grid Size" => Float of GridSize
        "Max X" => Integer of MaxX
        "Max Y" => Integer of MaxY
        "X" => Integer of (Path("Index"), "Mod", Path("Max X"))
        "Y" => Integer of (Path("Index"), "Quotient", Path("Max Y"))
        "X Coord" => Float of (Path("X"), "*", Path("Grid Size"))
        "Base Y Coord" => Float of (Path("Y"), "*", Path("Grid Size"))
        "Y Coord" => Float of (Path("Base Y Coord"), "Negate")
        "Partial Location" => Vec2 of (ZERO(), "Append", Path("X Coord"))
        "Local Location" => Vec3 of (Path("Partial Location"), "Append", Path("Y Coord"))
        "Location" => Vec3 of (Path("Offset"), "+", Path("Local Location"))
        "Item Offset" => Vec3 of V3X(-10.0)
        "Item Location" => Vec3 of (Path("Location"), "+", Path("Item Offset"))

slot_device<public> := class(tableau_device):
    @editable ResourceID<override>:string = "Slot"
    @editable SideEffectSettings<override>:side_effect_settings = side_effect_settings. PerResource := true

    GetResources<override>():[]resource=
        MaxX := 5
        MaxY := 5
        GridCount := MaxX * MaxY
        GridSize := 96.0
        Offset := GetTransform().Translation
        array. CreateSlotResource(Offset, GridSize, MaxX, MaxY)
