import * as R from 'ramda'

export default patches =>
    R.mapObjIndexed((old, key) => {
        if (!R.has(key, patches)) return old

        return (...args) => {
            const patch = R.view(R.lensProp(key), patches)
            const result = old(...args)

            return result.then ? result.then(patch) : patch(result)
        }
    })
