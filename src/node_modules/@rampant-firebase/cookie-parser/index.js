import cookie from 'cookie'

export default () => (req, res, next) => {
    const topLevelCookies = req.headers.cookie
        ? cookie.parse(req.headers.cookie)
        : {}
    const sessionCookie = topLevelCookies['__session']

    if (sessionCookie) {
        req.cookies = JSON.parse(decodeURIComponent(sessionCookie))
    }

    next()
}
